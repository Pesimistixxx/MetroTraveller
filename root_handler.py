import heapq

# stations_to_id_dict = {"Бульвар_Рокоссовского_1": 1, "Воробьёвы_горы_1": 22, "Проспект_Вернадского_1": 24, "Юго-Западная_1": 26, "Речной_вокзал_2": 7, "Славянский_бульвар_3": 102, "Филёвский_парк_4": 129, "Черкизовская_1": 8, "Красносельская_1": 11, "Комсомольская_1": 12, "Красные_Ворота_1": 13, "Лубянка_1": 15, "Охотный_Ряд_1": 16, "Библиотека_им._Ленина_1": 17, "Кропоткинская_1": 18, "Спортивная_1": 21, "Университет_1": 23, "Тропарёво_1": 33, "Румянцево_1": 34, "Филатов_Луг_1": 36, "Прокшино_1": 37, "Ольховая_1": 38, "Ховрино_2": 2, "Сокол_2": 41, "Аэропорт_2": 42, "Динамо_2": 43, "Маяковская_2": 45, "Тверская_2": 46, "Новокузнецкая_2": 48, "Павелецкая_2": 49, "Автозаводская_2": 88, "Технопарк_2": 89, "Каширская_2": 95, "Кантемировская_2": 98, "Царицыно_2": 101, "Орехово_2": 116, "Митино_3": 91, "Волоколамская_3": 93, "Мякинино_3": 94, "Строгино_3": 96, "Молодёжная_3": 99, "Кунцевская_4": 127, "Киевская_3": 112, "Смоленская_3": 115, "Арбатская_3": 117, "Курская_3": 119, "Бауманская_3": 120, "Электрозаводская_3": 121, "Семёновская_3": 122, "Измайловская_3": 124, "Первомайская_3": 125, "Щёлковская_3": 126, "Пионерская_4": 128, "Студенческая_4": 138, "Фили_4": 136, "Ленинский_проспект_6": 178, "Новые_Черёмушки_6": 181, "Улица_1905_года_7": 202, "Парк_культуры_5": 171, "Белорусская_5": 176, "Домодедовская_2": 142, "Алма-Атинская_2": 148, "Киевская_5": 173, "Киевская_4": 141, "Смоленская_4": 151, "Арбатская_4": 152, "Курская_5": 164, "Кутузовская_4": 137, "Проспект_Мира_5": 161, "Новослободская_5": 177, "Октябрьская_5": 170, "Октябрьская_6": 172, "Добрынинская_5": 168, "Медведково_6": 149, "Бабушкинская_6": 150, "Свиблово_6": 154, "ВДНХ_6": 156, "Алексеевская_6": 157, "Рижская_6": 158, "Сухаревская_6": 160, "Тургеневская_6": 162, "Китай-город_6": 166, "Академическая_6": 179, "Профсоюзная_6": 180, "Калужская_6": 182, "Беляево_6": 183, "Ясенево_6": 186, "Новоясеневская_6": 187, "Планерная_7": 191, "Сходненская_7": 193, "Спартак_7": 196, "Щукинская_7": 197, "Октябрьское_поле_7": 199, "Беговая_7": 201, "Баррикадная_7": 203, "Пушкинская_7": 204, "Алтуфьево_9": 188, "Бибирево_9": 189, "Владыкино_9": 192, "Петровско-Разумовская_9": 195, "Тимирязевская_9": 198, "Багратионовская_4": 133, "Павелецкая_5": 167, "Краснопресненская_5": 174, "Тёплый_Стан_6": 185, "Селигерская_10": 244, "Фонвизинская_10": 248, "Лермонтовский_проспект_7": 217, "Рязанский_проспект_7": 215, "Бутырская_10": 249, "Менделеевская_9": 211, "Достоевская_10": 251, "Трубная_10": 252, "Крестьянская_застава_10": 259, "Дубровка_10": 261, "Печатники_10": 265, "Третьяковская_8": 243, "Авиамоторная_8": 240, "Чкаловская_10": 255, "Братиславская_10": 270, "Марьино_10": 272, "Борисово_10": 273, "Сретенский_бульвар_10": 253, "Текстильщики_7": 213, "Таганская_7": 208, "Кузнецкий_мост_7": 206, "Шоссе_Энтузиастов_8": 239, "Площадь_Ильича_8": 241, "Улица_Академика_Янгеля_9": 233, "Нахимовский_проспект_9": 228, "Марьина_Роща_10": 250, "Пролетарская_7": 210, "Кузьминки_7": 214, "Выхино_7": 216, "Жулебино_7": 219, "Новокосино_8": 236, "Новогиреево_8": 237, "Перово_8": 238, "Римская_10": 257, "Петровско-Разумовская_10": 247, "Цветной_бульвар_9": 218, "Чеховская_9": 221, "Боровицкая_9": 222, "Полянка_9": 223, "Тульская_9": 225, "Нагатинская_9": 226, "Нагорная_9": 227, "Чертановская_9": 230, "Южная_9": 231, "Пражская_9": 232, "Аннино_9": 234, "Каховская_11": 266, "Тушинская_D2": 333, "Мичуринский_проспект_8A": 296, "Озёрная_8A": 298, "Улица_Старокачаловская_12": 279, "Говорово_8A": 300, "Солнцево_8A": 303, "Новопеределкино_8A": 306, "Тимирязевская_D1": 311, "Савёловская_D1": 312, "Лобня_D1": 290, "Бескудниково_D1": 307, "Рабочий_посёлок_D1": 319, "Красный_Балтиец_D2": 336, "Славянский_бульвар_D1": 317, "Фили_D1": 316, "Битцевский_парк_12": 277, "Бунинская_Аллея_12": 283, "Улица_Горчакова_12": 282, "Тестовская_(Москва-Сити)_D1": 315, "Белорусская_D1": 313, "Волоколамская_D2": 331, "Кунцевская_D1": 318, "Курская_D2": 344, "Щукинская_D2": 334, "Беговая_D1": 314, "Минская_8A": 291, "Лесопарковая_12": 278, "Лианозово_D1": 304, "Белокаменная_14": 342, "Волжская_10": 267, "Шереметьевская_D1": 292, "Хлебниково_D1": 295, "Водники_D1": 297, "Новодачная_D1": 301, "Марк_D1": 302, "Люблино_10": 268, "Дегунино_D1": 309, "Сетунь_D1": 320, "Немчиновка_D1": 321, "Сколково_D1": 322, "Одинцово_D1": 324, "Нахабино_D2": 325, "Аникеевка_D2": 326, "Опалиха_D2": 327, "Павшино_D2": 329, "Пенягино_D2": 330, "Трикотажная_D2": 332, "Стрешнево_D2": 335, "Гражданская_D2": 337, "Москва-Товарная_D2": 346, "Косино_15": 398, "Окская_15": 396, "Юго-Восточная_15": 397, "Лухмановская_15": 400, "Некрасовка_15": 401, "Люблино_D2": 354, "Нижегородская_15": 394, "Текстильщики_D2": 352, "Депо_D2": 356, "Калитники_D2": 348, "Перерва_D2": 358, "Курьяново_D2": 360, "Москворечье_D2": 362, "Покровское_D2": 365, "Крылатское_3": 97, "Бутово_D2": 371, "Щербинка_D2": 373, "Остафьево_D2": 374, "Силикатная_D2": 376, "Измайлово_14": 349, "Окружная_14": 389, "Ростокино_14": 340, "Площадь_Гагарина_14": 375, "Лефортово_11": 392, "Лихоборы_14": 388, "Владыкино_14": 390, "Кутузовская_14": 379, "Бульвар_Рокоссовского_14": 345, "Парк_Победы_3": 111, "Верхние_Котлы_14": 370, "Петровский_парк_11": 403, "Войковская_2": 40, "Белорусская_2": 44, "Автозаводская_14": 366, "Царицыно_D2": 363, "Рассказовка_8A": 308, "Савёловская_11": 402, "ЦСКА_11": 404, "Коптево_14": 387, "Балтийская_14": 386, "Панфиловская_14": 384, "Зорге_14": 383, "Хорошёво_14": 382, "Шелепиха_14": 381, "Крымская_14": 372, "ЗИЛ_14": 368, "Дубровка_14": 364, "Угрешская_14": 361, "Нижегородская_14": 357, "Андроновка_14": 355, "Соколиная_гора_14": 351, "Локомотив_14": 347, "Кунцевская_11": 423, "Деловой_центр_8A": 407, "Проспект_Вернадского_11": 427, "Печатники_D2": 445, "Зюзино_11": 430, "Воронцовская_11": 429, "Каширская_11": 271, "Электрозаводская_11": 408, "Новаторская_11": 428, "Мнёвники_11": 410, "Давыдково_11": 424, "Терехово_11": 422, "Площадь_трёх_вокзалов_D2": 343, "Марьина_Роща_D2": 501, "Марьина_Роща_11": 500, "Нагатинский_Затон_11": 496, "Кленовый_бульвар_11": 497, "Народное_Ополчение_11": 409, "Сокольники_11": 498, "Рижская_11": 499, "Рижская_D2": 341, "Авиамоторная_11": 393, "Варшавская_11": 269, "Печатники_11": 495, "Текстильщики_11": 494, "Нижегородская_11": 493, "Красный_Строитель_D2": 367, "Удельная_D3": 531, "Фабричная_D3": 537, "Кратово_D3": 535, "Отдых_D3": 534, "Ильинская_D3": 533, "Быково_D3": 532, "Малаховка_D3": 530, "Красково_D3": 529, "Томилино_D3": 528, "Новогиреево_D4": 546, "Внуково_D4": 567, "Выхино_D3": 523, "Ипподром_D3": 539, "Толстопальцево_D4": 569, "Лесной_Городок_D4": 568, "Раменское_D3": 538, "Кутузовская_D4": 557, "Переделкино_D4": 565, "Солнечная_D4": 564, "Мещерская_D4": 563, "Очаково_D4": 562, "Аминьевская_D4": 561, "Авиамоторная_D3": 518, "Матвеевская_D4": 560, "Панки_D3": 527, "Курская_D4": 551, "Ольгино_D4": 541, "Ховрино_D3": 510, "Марьина_Роща_D4": 553, "Электрозаводская_D3": 516, "Люберцы_D3": 526, "Серп_и_Молот_D4": 550, "Нижегородская_D4": 549, "Чухлинка_D4": 548, "Перово_D3": 520, "Кусково_D4": 547, "Реутов_D4": 545, "Салтыковская_D4": 543, "Кучино_D4": 542, "Косино_D3": 524, "Вешняки_D3": 522, "Плющево_D3": 521, "Андроновка_D3": 519, "Останкино_D3": 515, "Лихоборы_D3": 513, "Моссельмаш_D3": 512, "Левобережная_D3": 509, "Химки_D3": 508, "Петровско-Разумовская_D3": 514, "Молжаниново_D3": 507, "Савёловская_D4": 554, "Москва-Сити_D4": 556, "Белорусская_D4": 555, "Новоподрезково_D3": 506, "Подрезково_D3": 505, "Сходня_D3": 504, "Зеленоград-Крюково_D3": 502, "Сортировочная_D3": 517, "Физтех_10": 579, "Лианозово_10": 578, "Корниловская_16": 639, "Коммунарка_16": 640, "Пыхтино_8A": 580, "Санино_D4": 571, "Митьково_D3": 628, "Апрелевка_D4": 574, "Крёкшино_D4": 572, "Победа_D4": 573, "Новопеределкино_D4a": 576, "Новомосковская_16": 641, "Тютчевская_16": 637, "Новаторская_16": 634, "Новомосковская_1": 39, "Никольское_D4": 544, "Потапово_1": 638, "Площадь_трёх_вокзалов_D4": 552, "Солнечная_D4a": 575, "Генерала_Тюленева_16": 636, "Водный_стадион_2": 25, "Волгоградский_проспект_7": 212, "Верхние_Лихоборы_10": 245, "Александровский_сад_4": 153, "Преображенская_площадь_1": 9, "Шоссе_Энтузиастов_14": 353, "Парк_Победы_8A": 289, "Ломоносовский_проспект_8A": 293, "Мичуринский_проспект_11": 426, "Бульвар_Дмитрия_Донского_9": 235, "Аэропорт_Внуково_8A": 581, "Улица_Скобелевская_12": 280, "Бульвар_Адмирала_Ушакова_12": 281, "Сокольники_1": 10, "Комсомольская_5": 163, "Чистые_пруды_1": 14, "Парк_культуры_1": 19, "Фрунзенская_1": 20, "Саларьево_1": 35, "Беломорская_2": 6, "Театральная_2": 47, "Коломенская_2": 92, "Красногвардейская_2": 147, "Пятницкое_шоссе_3": 90, "Кунцевская_3": 100, "Площадь_Революции_3": 118, "Партизанская_3": 123, "Деловой_центр_4": 140, "Москва-Сити_14": 380, "Москва-Сити_4": 139, "Проспект_Мира_6": 159, "Таганская_5": 165, "Ботанический_сад_6": 155, "Ботанический_сад_14": 338, "Китай-город_7": 207, "Шаболовская_6": 175, "Коньково_6": 184, "Тушинская_7": 194, "Полежаевская_7": 200, "Котельники_7": 220, "Марксистская_8": 242, "Минская_D4": 559, "Боровское_шоссе_8A": 305, "Отрадное_9": 190, "Дмитровская_D2": 339, "Дмитровская_9": 205, "Савёловская_9": 209, "Серпуховская_9": 224, "Севастопольская_9": 229, "Хорошёвская_11": 405, "Аминьевская_11": 425, "Стрешнево_14": 385, "Лужники_14": 377, "Новохохловская_14": 359, "Яхромская_10": 577, "Стахановская_15": 395, "Улица_Дмитриевского_15": 399, "Окружная_D1": 310, "Окружная_10": 246, "Кожуховская_10": 263, "Долгопрудная_D1": 299, "Шипиловская_10": 274, "Зябликово_10": 275, "Железнодорожная_D4": 540, "Баковка_D1": 323, "Красногорская_D2": 328, "Новохохловская_D2": 350, "Битца_D2": 369, "Подольск_D2": 378, "Поклонная_D4": 558, "Мичуринец_D4": 566, "Кокошкино_D4": 570, "Есенинская_D3": 536, "Ухтомская_D3": 525, "Грачёвская_D3": 511, "Фирсановская_D3": 503, "Третьяковская_6": 169, "Раменки_8A": 294, "Университет_Дружбы_Народов_16": 635, "ЗИЛ_16": 666, "Крымская_16": 665, "Академическая_16": 664, "Вавиловская_16": 663}
# id_to_stations_dict = {1: "Бульвар_Рокоссовского_1", 22: "Воробьёвы_горы_1", 24: "Проспект_Вернадского_1", 26: "Юго-Западная_1", 7: "Речной_вокзал_2", 102: "Славянский_бульвар_3", 129: "Филёвский_парк_4", 8: "Черкизовская_1", 11: "Красносельская_1", 12: "Комсомольская_1", 13: "Красные_Ворота_1", 15: "Лубянка_1", 16: "Охотный_Ряд_1", 17: "Библиотека_им._Ленина_1", 18: "Кропоткинская_1", 21: "Спортивная_1", 23: "Университет_1", 33: "Тропарёво_1", 34: "Румянцево_1", 36: "Филатов_Луг_1", 37: "Прокшино_1", 38: "Ольховая_1", 2: "Ховрино_2", 41: "Сокол_2", 42: "Аэропорт_2", 43: "Динамо_2", 45: "Маяковская_2", 46: "Тверская_2", 48: "Новокузнецкая_2", 49: "Павелецкая_2", 88: "Автозаводская_2", 89: "Технопарк_2", 95: "Каширская_2", 98: "Кантемировская_2", 101: "Царицыно_2", 116: "Орехово_2", 91: "Митино_3", 93: "Волоколамская_3", 94: "Мякинино_3", 96: "Строгино_3", 99: "Молодёжная_3", 127: "Кунцевская_4", 112: "Киевская_3", 115: "Смоленская_3", 117: "Арбатская_3", 119: "Курская_3", 120: "Бауманская_3", 121: "Электрозаводская_3", 122: "Семёновская_3", 124: "Измайловская_3", 125: "Первомайская_3", 126: "Щёлковская_3", 128: "Пионерская_4", 138: "Студенческая_4", 136: "Фили_4", 178: "Ленинский_проспект_6", 181: "Новые_Черёмушки_6", 202: "Улица_1905_года_7", 171: "Парк_культуры_5", 176: "Белорусская_5", 142: "Домодедовская_2", 148: "Алма-Атинская_2", 173: "Киевская_5", 141: "Киевская_4", 151: "Смоленская_4", 152: "Арбатская_4", 164: "Курская_5", 137: "Кутузовская_4", 161: "Проспект_Мира_5", 177: "Новослободская_5", 170: "Октябрьская_5", 172: "Октябрьская_6", 168: "Добрынинская_5", 149: "Медведково_6", 150: "Бабушкинская_6", 154: "Свиблово_6", 156: "ВДНХ_6", 157: "Алексеевская_6", 158: "Рижская_6", 160: "Сухаревская_6", 162: "Тургеневская_6", 166: "Китай-город_6", 179: "Академическая_6", 180: "Профсоюзная_6", 182: "Калужская_6", 183: "Беляево_6", 186: "Ясенево_6", 187: "Новоясеневская_6", 191: "Планерная_7", 193: "Сходненская_7", 196: "Спартак_7", 197: "Щукинская_7", 199: "Октябрьское_поле_7", 201: "Беговая_7", 203: "Баррикадная_7", 204: "Пушкинская_7", 188: "Алтуфьево_9", 189: "Бибирево_9", 192: "Владыкино_9", 195: "Петровско-Разумовская_9", 198: "Тимирязевская_9", 133: "Багратионовская_4", 167: "Павелецкая_5", 174: "Краснопресненская_5", 185: "Тёплый_Стан_6", 244: "Селигерская_10", 248: "Фонвизинская_10", 217: "Лермонтовский_проспект_7", 215: "Рязанский_проспект_7", 249: "Бутырская_10", 211: "Менделеевская_9", 251: "Достоевская_10", 252: "Трубная_10", 259: "Крестьянская_застава_10", 261: "Дубровка_10", 265: "Печатники_10", 243: "Третьяковская_8", 240: "Авиамоторная_8", 255: "Чкаловская_10", 270: "Братиславская_10", 272: "Марьино_10", 273: "Борисово_10", 253: "Сретенский_бульвар_10", 213: "Текстильщики_7", 208: "Таганская_7", 206: "Кузнецкий_мост_7", 239: "Шоссе_Энтузиастов_8", 241: "Площадь_Ильича_8", 233: "Улица_Академика_Янгеля_9", 228: "Нахимовский_проспект_9", 250: "Марьина_Роща_10", 210: "Пролетарская_7", 214: "Кузьминки_7", 216: "Выхино_7", 219: "Жулебино_7", 236: "Новокосино_8", 237: "Новогиреево_8", 238: "Перово_8", 257: "Римская_10", 247: "Петровско-Разумовская_10", 218: "Цветной_бульвар_9", 221: "Чеховская_9", 222: "Боровицкая_9", 223: "Полянка_9", 225: "Тульская_9", 226: "Нагатинская_9", 227: "Нагорная_9", 230: "Чертановская_9", 231: "Южная_9", 232: "Пражская_9", 234: "Аннино_9", 266: "Каховская_11", 333: "Тушинская_D2", 296: "Мичуринский_проспект_8A", 298: "Озёрная_8A", 279: "Улица_Старокачаловская_12", 300: "Говорово_8A", 303: "Солнцево_8A", 306: "Новопеределкино_8A", 311: "Тимирязевская_D1", 312: "Савёловская_D1", 290: "Лобня_D1", 307: "Бескудниково_D1", 319: "Рабочий_посёлок_D1", 336: "Красный_Балтиец_D2", 317: "Славянский_бульвар_D1", 316: "Фили_D1", 277: "Битцевский_парк_12", 283: "Бунинская_Аллея_12", 282: "Улица_Горчакова_12", 315: "Тестовская_(Москва-Сити)_D1", 313: "Белорусская_D1", 331: "Волоколамская_D2", 318: "Кунцевская_D1", 344: "Курская_D2", 334: "Щукинская_D2", 314: "Беговая_D1", 291: "Минская_8A", 278: "Лесопарковая_12", 304: "Лианозово_D1", 342: "Белокаменная_14", 267: "Волжская_10", 292: "Шереметьевская_D1", 295: "Хлебниково_D1", 297: "Водники_D1", 301: "Новодачная_D1", 302: "Марк_D1", 268: "Люблино_10", 309: "Дегунино_D1", 320: "Сетунь_D1", 321: "Немчиновка_D1", 322: "Сколково_D1", 324: "Одинцово_D1", 325: "Нахабино_D2", 326: "Аникеевка_D2", 327: "Опалиха_D2", 329: "Павшино_D2", 330: "Пенягино_D2", 332: "Трикотажная_D2", 335: "Стрешнево_D2", 337: "Гражданская_D2", 346: "Москва-Товарная_D2", 398: "Косино_15", 396: "Окская_15", 397: "Юго-Восточная_15", 400: "Лухмановская_15", 401: "Некрасовка_15", 354: "Люблино_D2", 394: "Нижегородская_15", 352: "Текстильщики_D2", 356: "Депо_D2", 348: "Калитники_D2", 358: "Перерва_D2", 360: "Курьяново_D2", 362: "Москворечье_D2", 365: "Покровское_D2", 97: "Крылатское_3", 371: "Бутово_D2", 373: "Щербинка_D2", 374: "Остафьево_D2", 376: "Силикатная_D2", 349: "Измайлово_14", 389: "Окружная_14", 340: "Ростокино_14", 375: "Площадь_Гагарина_14", 392: "Лефортово_11", 388: "Лихоборы_14", 390: "Владыкино_14", 379: "Кутузовская_14", 345: "Бульвар_Рокоссовского_14", 111: "Парк_Победы_3", 370: "Верхние_Котлы_14", 403: "Петровский_парк_11", 40: "Войковская_2", 44: "Белорусская_2", 366: "Автозаводская_14", 363: "Царицыно_D2", 308: "Рассказовка_8A", 402: "Савёловская_11", 404: "ЦСКА_11", 387: "Коптево_14", 386: "Балтийская_14", 384: "Панфиловская_14", 383: "Зорге_14", 382: "Хорошёво_14", 381: "Шелепиха_14", 372: "Крымская_14", 368: "ЗИЛ_14", 364: "Дубровка_14", 361: "Угрешская_14", 357: "Нижегородская_14", 355: "Андроновка_14", 351: "Соколиная_гора_14", 347: "Локомотив_14", 423: "Кунцевская_11", 407: "Деловой_центр_8A", 427: "Проспект_Вернадского_11", 445: "Печатники_D2", 430: "Зюзино_11", 429: "Воронцовская_11", 271: "Каширская_11", 408: "Электрозаводская_11", 428: "Новаторская_11", 410: "Мнёвники_11", 424: "Давыдково_11", 422: "Терехово_11", 343: "Площадь_трёх_вокзалов_D2", 501: "Марьина_Роща_D2", 500: "Марьина_Роща_11", 496: "Нагатинский_Затон_11", 497: "Кленовый_бульвар_11", 409: "Народное_Ополчение_11", 498: "Сокольники_11", 499: "Рижская_11", 341: "Рижская_D2", 393: "Авиамоторная_11", 269: "Варшавская_11", 495: "Печатники_11", 494: "Текстильщики_11", 493: "Нижегородская_11", 367: "Красный_Строитель_D2", 531: "Удельная_D3", 537: "Фабричная_D3", 535: "Кратово_D3", 534: "Отдых_D3", 533: "Ильинская_D3", 532: "Быково_D3", 530: "Малаховка_D3", 529: "Красково_D3", 528: "Томилино_D3", 546: "Новогиреево_D4", 567: "Внуково_D4", 523: "Выхино_D3", 539: "Ипподром_D3", 569: "Толстопальцево_D4", 568: "Лесной_Городок_D4", 538: "Раменское_D3", 557: "Кутузовская_D4", 565: "Переделкино_D4", 564: "Солнечная_D4", 563: "Мещерская_D4", 562: "Очаково_D4", 561: "Аминьевская_D4", 518: "Авиамоторная_D3", 560: "Матвеевская_D4", 527: "Панки_D3", 551: "Курская_D4", 541: "Ольгино_D4", 510: "Ховрино_D3", 553: "Марьина_Роща_D4", 516: "Электрозаводская_D3", 526: "Люберцы_D3", 550: "Серп_и_Молот_D4", 549: "Нижегородская_D4", 548: "Чухлинка_D4", 520: "Перово_D3", 547: "Кусково_D4", 545: "Реутов_D4", 543: "Салтыковская_D4", 542: "Кучино_D4", 524: "Косино_D3", 522: "Вешняки_D3", 521: "Плющево_D3", 519: "Андроновка_D3", 515: "Останкино_D3", 513: "Лихоборы_D3", 512: "Моссельмаш_D3", 509: "Левобережная_D3", 508: "Химки_D3", 514: "Петровско-Разумовская_D3", 507: "Молжаниново_D3", 554: "Савёловская_D4", 556: "Москва-Сити_D4", 555: "Белорусская_D4", 506: "Новоподрезково_D3", 505: "Подрезково_D3", 504: "Сходня_D3", 502: "Зеленоград-Крюково_D3", 517: "Сортировочная_D3", 579: "Физтех_10", 578: "Лианозово_10", 639: "Корниловская_16", 640: "Коммунарка_16", 580: "Пыхтино_8A", 571: "Санино_D4", 628: "Митьково_D3", 574: "Апрелевка_D4", 572: "Крёкшино_D4", 573: "Победа_D4", 576: "Новопеределкино_D4a", 641: "Новомосковская_16", 637: "Тютчевская_16", 634: "Новаторская_16", 39: "Новомосковская_1", 544: "Никольское_D4", 638: "Потапово_1", 552: "Площадь_трёх_вокзалов_D4", 575: "Солнечная_D4a", 636: "Генерала_Тюленева_16", 25: "Водный_стадион_2", 212: "Волгоградский_проспект_7", 245: "Верхние_Лихоборы_10", 153: "Александровский_сад_4", 9: "Преображенская_площадь_1", 353: "Шоссе_Энтузиастов_14", 289: "Парк_Победы_8A", 293: "Ломоносовский_проспект_8A", 426: "Мичуринский_проспект_11", 235: "Бульвар_Дмитрия_Донского_9", 581: "Аэропорт_Внуково_8A", 280: "Улица_Скобелевская_12", 281: "Бульвар_Адмирала_Ушакова_12", 10: "Сокольники_1", 163: "Комсомольская_5", 14: "Чистые_пруды_1", 19: "Парк_культуры_1", 20: "Фрунзенская_1", 35: "Саларьево_1", 6: "Беломорская_2", 47: "Театральная_2", 92: "Коломенская_2", 147: "Красногвардейская_2", 90: "Пятницкое_шоссе_3", 100: "Кунцевская_3", 118: "Площадь_Революции_3", 123: "Партизанская_3", 140: "Деловой_центр_4", 380: "Москва-Сити_14", 139: "Москва-Сити_4", 159: "Проспект_Мира_6", 165: "Таганская_5", 155: "Ботанический_сад_6", 338: "Ботанический_сад_14", 207: "Китай-город_7", 175: "Шаболовская_6", 184: "Коньково_6", 194: "Тушинская_7", 200: "Полежаевская_7", 220: "Котельники_7", 242: "Марксистская_8", 559: "Минская_D4", 305: "Боровское_шоссе_8A", 190: "Отрадное_9", 339: "Дмитровская_D2", 205: "Дмитровская_9", 209: "Савёловская_9", 224: "Серпуховская_9", 229: "Севастопольская_9", 405: "Хорошёвская_11", 425: "Аминьевская_11", 385: "Стрешнево_14", 377: "Лужники_14", 359: "Новохохловская_14", 577: "Яхромская_10", 395: "Стахановская_15", 399: "Улица_Дмитриевского_15", 310: "Окружная_D1", 246: "Окружная_10", 263: "Кожуховская_10", 299: "Долгопрудная_D1", 274: "Шипиловская_10", 275: "Зябликово_10", 540: "Железнодорожная_D4", 323: "Баковка_D1", 328: "Красногорская_D2", 350: "Новохохловская_D2", 369: "Битца_D2", 378: "Подольск_D2", 558: "Поклонная_D4", 566: "Мичуринец_D4", 570: "Кокошкино_D4", 536: "Есенинская_D3", 525: "Ухтомская_D3", 511: "Грачёвская_D3", 503: "Фирсановская_D3", 169: "Третьяковская_6", 294: "Раменки_8A", 635: "Университет_Дружбы_Народов_16", 666: "ЗИЛ_16", 665: "Крымская_16", 664: "Академическая_16", 663: "Вавиловская_16"}
stations_to_id_dict = {}
id_to_stations_dict = {}

with open('stations_data.txt', 'r') as f:
    for line in f.readlines():
        stations_to_id_dict[line.split()[1]] = int(line.split()[0])
        id_to_stations_dict[int(line.split()[0])] = line.split()[1]


def dijkstra(graph, start, end=None):
    """
    Реализация алгоритма Дейкстры для нахождения кратчайших путей

    Args:
        graph: словарь, представляющий граф {вершина: [(сосед, вес), ...]}
        start: начальная вершина
        end: конечная вершина (опционально)

    Returns:
        Если указана end: возвращает (кратчайший путь, расстояние)
        Иначе: возвращает словарь расстояний до всех вершин
    """

    distances = {node: float('infinity') for node in graph}
    distances[start] = 0
    previous_nodes = {node: None for node in graph}
    priority_queue = [(0, start)]

    while priority_queue:
        current_distance, current_node = heapq.heappop(priority_queue)

        if end and current_node == end:
            break

        if current_distance > distances[current_node]:
            continue

        for neighbor, weight in graph[current_node]:
            distance = current_distance + weight

            if distance < distances[neighbor]:
                distances[neighbor] = distance
                previous_nodes[neighbor] = current_node
                heapq.heappush(priority_queue, (distance, neighbor))

    if end:
        path = []
        current = end

        while current is not None:
            path.append(id_to_stations_dict[current])
            current = previous_nodes[current]

        path.reverse()
        return distances[end], distances[end]/60, path

    return distances


